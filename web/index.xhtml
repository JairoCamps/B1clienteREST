<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:p="http://primefaces.org/ui">
    <h:head>
        <title>Series</title>
        <!-- Parámetros necesarios para Oauth -->
        <meta charset='utf-8' />
        <meta name="google-signin-client_id" content="35516512073-md7a4298ahau8spg0t83u6rf2krmeq3k.apps.googleusercontent.com"/>
        
        <!-- Librerías para estilo  -->
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous"></link>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
        <script src="//code.jquery.com/jquery-1.11.1.min.js"></script>
        
        <!-- Librería propia con funciones para el cierre de sesión -->
        <h:outputScript library="js" name="logoutUtils.js"/>

         <script src="https://apis.google.com/js/platform.js?onload=onLoad" ></script>
 
    </h:head>
    <h:body style="background-color: #6699ff">
         <div class="jumbotron" style="background-color: #39CCCC ">
            <div class="container">
                <h1>Bienvenido a DComics #{loginBean.emailUser}</h1> 
                <b>Tu aplicación para gestión de series de comics.</b> 
            </div>
            <img src="#{loginBean.imageUrl}" align="right" class="rounded-circle"/>
        </div>
         
        <nav class="navbar navbar-light bg-light justify-content-between">
            <a class="navbar-brand">Índice de Cómics</a>
            <h:form class="form-inline">
                <h:link outcome="login"  id="linkLogout" class="btn btn-outline-danger" value="Cerrar Sesión" onclick="signOut();" rendered="#{not empty loginBean.emailUser}"/>
            </h:form>
        </nav>
        <h:form>
            <p:remoteCommand name="logoutMB" actionListener="#{loginBean.logout()}" id="remote_action" autoRun="false"  process="@this" update="@this"></p:remoteCommand>
        </h:form>
        
        
        <h1 align="center">Lista de Series </h1>
        <hr></hr>
        <br></br>
        
        <style type="text/css">
            .ui-button{
            height:25px;
        }
            .ui-widget {
            font-size: 13px;
        }           font-family:verdana
            
        .color {
            background-color: #cccccc !important;
        background-image: none !important;
        color: #000000 !important;
        }
        </style>
        
        <h:form>
            <p:outputLabel value="Crear nueva categoria:" style="vertical-align:middle; "/>
            <p:inputText required ="false" value="#{createCategoriaBean.c.nombre}"  style="vertical-align:middle;"/>
            <p:commandButton value="Crear" action="#{createCategoriaBean.crearCategoria(createCategoriaBean.c.nombre)}" style="vertical-align:middle;" ajax="false"  />
        </h:form>

        <h:form id="form">
            <p:selectOneMenu value="#{indexBean.categoriaIdSeleccionada}" style="vertical-align:middle; ">
                <f:selectItem itemLabel="Selecciona Categoría..." itemValue="" />
                <f:selectItems value="#{indexBean.listaCategoria}" var="categoria" itemLabel="#{categoria.nombre}" itemValue="#{categoria.idCategoria}"/>
                <p:ajax  event="valueChange" listener="#{indexBean.actualizarTabla()}" update=":form:tabla"/>
            </p:selectOneMenu>
       
        <p:dataTable  id="tabla" var="serie" value="#{indexBean.listaSeries}" scrollable="true" 
                      scrollHeight="350" rowStyleClass="#{serie.idSerie%2==0 ? 'color' : null}">
            <p:column headerText="Id">
                <h:outputText value="#{serie.idSerie}" />
            </p:column>

            <p:column headerText="Nombre">
                <h:link outcome="verSerieComics" >
                    <h:outputText value="#{serie.nombre}" />
                    <f:param name="idSerie" value="#{serie.idSerie}" />
                </h:link>
                
            </p:column>

            <p:column headerText="Autor">
                <h:outputText value="#{serie.autor}" />
            </p:column>

            <p:column headerText="Descripción" width="900">
                <h:outputText value="#{serie.descripcion}" />
            </p:column>
            <p:column headerText="Fecha" >
                <h:outputText value="#{serie.fecha}" />
            </p:column>
            <p:column headerText="Editar" >
                <p:commandButton value="Editar" action="#{indexBean.doEdit(serie.idSerie)}"></p:commandButton>
            </p:column>
        </p:dataTable>
            
        </h:form>
    </h:body>
</html>
